# Documentaci√≥n del Proyecto

## Gu√≠a de Usuario
# Gu√≠a de Usuario

Bienvenido a la herramienta de an√°lisis y procesamiento de informaci√≥n. Esta aplicaci√≥n te ayudar√° a transformar grandes vol√∫menes de datos en insights claros y accionables a trav√©s de una interfaz web amigable.

---

## üì± ¬øQu√© es esta aplicaci√≥n?

- **Prop√≥sito principal:**  
  Esta herramienta permite analizar informaci√≥n contenida en archivos PDF, conversaciones y datos de Voz del Cliente (VoC) de forma interactiva. Utiliza modelos de lenguaje basados en IA para interpretar y extraer datos relevantes, facilitando el entendimiento y la toma de decisiones.

- **Problema que resuelve:**  
  Si necesitas extraer conocimientos de informes extensos, analizar di√°logos o entender las opiniones y comentarios de tus clientes, nuestra aplicaci√≥n automatiza estas tareas para ahorrarte tiempo y reducir errores en la interpretaci√≥n manual.

- **Beneficios clave:**  
  ‚Ä¢ Ahorro de tiempo gracias a procesos autom√°ticos.  
  ‚Ä¢ Resultados claros y visuales que facilitan la toma de decisiones.  
  ‚Ä¢ Soporte para m√∫ltiples tipos de an√°lisis: documentos, conversaciones y feedback de clientes.  
  ‚Ä¢ Acceso a insights que pueden potenciar estrategias de negocio y atenci√≥n al cliente.

- **Audiencia objetivo:**  
  Profesionales en √°reas de an√°lisis de datos, atenci√≥n al cliente, marketing, investigaci√≥n de mercado y equipos de soporte que necesiten transformar grandes vol√∫menes de informaci√≥n en datos √∫tiles.

---

## ‚ú® Funcionalidades Principales

### Interfaz Web Interactiva
- **¬øQu√© hace?**  
  Ofrece un entorno visual y f√°cil de usar donde puedes navegar entre las diferentes funcionalidades de la aplicaci√≥n, subir archivos, configurar an√°lisis y visualizar resultados en tiempo real.

- **¬øCu√°ndo usarla?**  
  Cada vez que necesites acceder a la herramienta, revisar resultados o configurar un nuevo an√°lisis, la interfaz act√∫a como tu punto de entrada principal.

- **¬øC√≥mo acceder?**  
  Simplemente abre tu navegador y dir√≠gete a la URL proporcionada. Una vez cargada, encontrar√°s un men√∫ claro para navegar entre las opciones disponibles.

- **Resultado esperado:**  
  Una pantalla limpia con opciones de men√∫, botones y paneles de visualizaci√≥n que te permiten interactuar f√°cilmente con la aplicaci√≥n.

### Procesamiento de Archivos PDF
- **¬øQu√© hace?**  
  Permite cargar archivos PDF para extraer y procesar su contenido textual de manera autom√°tica, listo para ser analizado.

- **¬øCu√°ndo usarla?**  
  √ösala cuando necesites analizar reportes, documentos o cualquier otro archivo PDF que contenga informaci√≥n relevante.

- **¬øC√≥mo acceder?**  
  En la interfaz principal, selecciona la opci√≥n "Procesar PDF", luego arrastra y suelta tu archivo o haz clic para buscarlo en tu ordenador.

- **Resultado esperado:**  
  Una vista previa del contenido del documento extra√≠do y listo para someterlo a an√°lisis con modelos de lenguaje.

### An√°lisis con Modelos de Lenguaje (IA)
- **¬øQu√© hace?**  
  Utiliza algoritmos de inteligencia artificial para interpretar el contenido textual, identificar patrones y extraer insights valiosos.

- **¬øCu√°ndo usarla?**  
  Ideal para analizar grandes vol√∫menes de texto cuando buscas extraer informaci√≥n espec√≠fica, generar res√∫menes o obtener recomendaciones basadas en el contenido.

- **¬øC√≥mo acceder?**  
  Tras procesar un archivo o ingresar un texto, selecciona la opci√≥n "Analizar con IA" y sigue las indicaciones en pantalla.

- **Resultado esperado:**  
  Un reporte detallado con insights, clasificaciones y sugerencias basadas en los datos analizados.

### An√°lisis de Conversaciones
- **¬øQu√© hace?**  
  Permite cargar transcripciones o registros de conversaciones (como chats o llamadas) para analizarlas y extraer temas recurrentes y sentiment analysis.

- **¬øCu√°ndo usarla?**  
  Cuando necesites entender el flujo de las conversaciones de soporte, detectar problemas recurrentes o medir el tono general de las interacciones.

- **¬øC√≥mo acceder?**  
  Desde la interfaz, elige la secci√≥n "An√°lisis de Conversaciones", carga tus archivos o pega el texto y activa el proceso de an√°lisis.

- **Resultado esperado:**  
  Visualizaciones y reportes que muestran los temas predominantes, la frecuencia de palabras clave y an√°lisis de sentimientos.

### An√°lisis de Voz del Cliente (VoC)
- **¬øQu√© hace?**  
  Eval√∫a comentarios, rese√±as y feedback de clientes, permitiendo identificar tendencias, niveles de satisfacci√≥n y √°reas de mejora.

- **¬øCu√°ndo usarla?**  
  √ösala cuando desees conocer en profundidad la opini√≥n de tus clientes para mejorar productos, servicios o procesos internos.

- **¬øC√≥mo acceder?**  
  En el men√∫, selecciona "Voz del Cliente (VoC)", sube los archivos o introduce los comentarios y empieza el an√°lisis.

- **Resultado esperado:**  
  Un informe enfocado en las percepciones del cliente, destacando opiniones positivas, cr√≠ticas y sugerencias de mejora.

---

## üöÄ C√≥mo Empezar

### Primer Uso
1. **Requisitos previos:**  
   - Una conexi√≥n estable a Internet.  
   - Un navegador web actualizado.  
   - Archivos PDF o textos de conversaciones/listados de feedback (si aplica).
2. **Acceso inicial:**  
   Ingresa a la aplicaci√≥n usando la URL proporcionada. La p√°gina de inicio te dar√° la bienvenida y mostrar√° las opciones principales.
3. **Configuraci√≥n b√°sica:**  
   Revisa la configuraci√≥n de idioma y visualizaci√≥n. No es necesaria una configuraci√≥n avanzada, la aplicaci√≥n est√° lista para usar.
4. **Primera tarea recomendada:**  
   Sube un archivo PDF y realiza un an√°lisis b√°sico para familiarizarte con la interfaz y el proceso de extracci√≥n de informaci√≥n.

### Flujo T√≠pico de Uso
1. **Paso 1:**  
   Accede a la interfaz web mediante tu navegador.
2. **Paso 2:**  
   Selecciona la funcionalidad deseada (por ejemplo, "Procesar PDF" o "An√°lisis de Conversaciones").
3. **Paso 3:**  
   Sube el archivo o ingresa el texto, y luego activa el an√°lisis.
4. **Paso 4:**  
   Visualiza el reporte generado, explora los insights y, si es necesario, ajusta los par√°metros del an√°lisis para afinar los resultados.

---

## üí° Casos de Uso Comunes

### Escenario 1: An√°lisis de Reportes en PDF
**Situaci√≥n:**  
Necesitas extraer informaci√≥n clave de un informe extenso para presentar insights a tu equipo.

**Pasos:**  
1. Ingresa a la aplicaci√≥n y selecciona "Procesar PDF".  
2. Sube el informe en formato PDF.  
3. Activa el an√°lisis con IA para resumir y resaltar puntos importantes.  
4. Revisa el informe generado y utiliza la informaci√≥n para preparar tu presentaci√≥n.

### Escenario 2: Evaluaci√≥n de Conversaciones de Soporte
**Situaci√≥n:**  
Quieres identificar temas comunes y detectar √°reas de mejora en las interacciones de soporte al cliente.

**Pasos:**  
1. Accede a "An√°lisis de Conversaciones".  
2. Carga las transcripciones de chats o registros de llamadas.  
3. Ejecuta el an√°lisis y observa las visualizaciones y res√∫menes.  
4. Usa los resultados para capacitar a tu equipo y optimizar procesos.

### Escenario 3: Revisi√≥n de la Voz del Cliente (VoC)
**Situaci√≥n:**  
Deseas conocer la percepci√≥n de tus clientes acerca de un nuevo producto o servicio.

**Pasos:**  
1. Selecciona "Voz del Cliente (VoC)" en la interfaz.  
2. Sube los comentarios, encuestas o rese√±as de clientes.  
3. Inicia el an√°lisis y espera a que se generen los insights.  
4. Analiza el feedback para descubrir tendencias y √°reas a mejorar.

---

## ‚ùì Preguntas Frecuentes

**P: ¬øC√≥mo puedo cargar un archivo PDF para su an√°lisis?**  
R: Simplemente dir√≠gete a la secci√≥n "Procesar PDF", arrastra y suelta el archivo o haz clic para seleccionarlo desde tu dispositivo.

**P: ¬øQu√© hago si el an√°lisis tarda demasiado en completarse?**  
R: Verifica tu conexi√≥n a Internet y aseg√∫rate de que el archivo no sea excesivamente grande. Si el problema persiste, reinicia el proceso o contacta al soporte.

**P: ¬øEs seguro usar la herramienta con datos confidenciales?**  
R: S√≠, la aplicaci√≥n aplica medidas de seguridad b√°sicas para proteger la informaci√≥n. Sin embargo, te recomendamos evitar cargar documentos altamente sensibles o confidenciales.

**P: ¬øCu√°les son las limitaciones principales de la aplicaci√≥n?**  
R: La herramienta est√° optimizada para formatos de texto comunes. Puede tener dificultades con documentos escaneados sin reconocimiento √≥ptico (OCR) o con formatos de archivos no soportados. Adem√°s, la precisi√≥n del an√°lisis depender√° de la calidad del texto subido.

---

## üÜò Soluci√≥n de Problemas

### Problema: Error al Cargar un Archivo PDF
**S√≠ntomas:**  
El archivo no se sube o aparece un mensaje de error durante la carga.

**Causa probable:**  
El archivo puede estar da√±ado, ser incompatible o exceder el tama√±o permitido.

**Soluci√≥n:**  
1. Verifica que el PDF se abra correctamente en otro visor.  
2. Aseg√∫rate de que cumple con los requisitos de formato y tama√±o.  
3. Intenta disminuir el tama√±o o convertir el archivo y vuelve a intentarlo.

### Problema: Resultados Inesperados en el An√°lisis de Conversaciones
**S√≠ntomas:**  
El reporte no muestra temas definidos o los insights parecen confusos.

**Causa probable:**  
El texto podr√≠a contener errores, estar mal estructurado o tener un formato inusual.

**Soluci√≥n:**  
1. Revisa la calidad del texto cargado y corrige posibles errores de transcripci√≥n.  
2. Aseg√∫rate de que las conversaciones est√©n bien delimitadas (por ejemplo, identificadores de interlocutores).  
3. Ejecuta nuevamente el proceso de an√°lisis.

### Problema: Lentitud en la Visualizaci√≥n de Resultados
**S√≠ntomas:**  
El an√°lisis tarda m√°s de lo esperado o la interfaz responde lentamente.

**Causa probable:**  
Puede ser un problema de conexi√≥n a Internet o una gran cantidad de datos a procesar.

**Soluci√≥n:**  
1. Comprueba tu conexi√≥n a Internet.  
2. Intenta realizar el an√°lisis en momentos de menor actividad.  
3. Si el problema persiste, contacta al soporte indicando el problema.

---

## üìû Soporte y Contacto
- **¬øNecesitas ayuda adicional?**  
  Comun√≠cate con nuestro equipo de soporte al correo soporte@tuempresa.com.
- **¬øEncontraste un error?**  
  Reporta cualquier fallo o comportamiento inesperado a trav√©s del formulario de feedback disponible en la herramienta.
- **¬øTienes sugerencias?**  
  Nos encantar√≠a saber c√≥mo podemos mejorar. Env√≠a tus ideas y comentarios a feedback@tuempresa.com.

---

Esperamos que esta gu√≠a te sea √∫til para aprovechar al m√°ximo la aplicaci√≥n. ¬°Disfruta del an√°lisis y la extracci√≥n de insights de forma sencilla y eficiente!

## Documentaci√≥n T√©cnica
A continuaci√≥n se presenta la documentaci√≥n t√©cnica completa en Markdown, siguiendo la estructura solicitada y basada en el an√°lisis del c√≥digo proporcionado.

----------------------------------------------------------------
# Documentaci√≥n T√©cnica

Esta documentaci√≥n est√° orientada a desarrolladores y equipos t√©cnicos interesados en comprender, mantener y extender la aplicaci√≥n VoC Analyst. Esta herramienta permite procesar archivos (PDF y TXT), extraer y normalizar informaci√≥n de conversaciones y, a trav√©s de la integraci√≥n con proveedores de modelos de lenguaje (LLM), generar insights sobre la Voz del Cliente (VoC). La interfaz se implementa con Streamlit y el procesamiento se realiza en un √∫nico m√≥dulo monol√≠tico con responsabilidades bien definidas.

----------------------------------------------------------------
## üèóÔ∏è Arquitectura del Sistema

- **Patr√≥n arquitect√≥nico utilizado:**  
  La aplicaci√≥n sigue un enfoque modular monol√≠tico ‚Äúh√≠brido‚Äù en el que se integran la interfaz de usuario (Frontend) con la l√≥gica de negocio (Backend).  
  - La **Capa de Presentaci√≥n** se implementa con Streamlit, y es responsable de la carga de archivos, manejo de la interacci√≥n y visualizaci√≥n din√°mica de resultados.  
  - La **Capa de L√≥gica y An√°lisis** se compone de m√≥dulos para la extracci√≥n y validaci√≥n de archivos (por ejemplo, utilizando PyPDF2 para extraer texto), el parsing y normalizaci√≥n de conversaciones (incluyendo redacci√≥n de PII) y la integraci√≥n con proveedores de Modelos de Lenguaje (LLM) a trav√©s del m√≥dulo LLMBackend.

- **Diagrama de componentes:**  
  A continuaci√≥n se muestra un diagrama Mermaid que resume la estructura del sistema:

  ```mermaid
  graph LR
      A[Interfaz Streamlit (Frontend)] --> B[Procesamiento y Validaci√≥n de Archivos]
      A --> C[Gesti√≥n del Estado (st.session_state)]
      B --> D[Extracci√≥n de Texto (PyPDF2)]
      B --> E[Parser y Redacci√≥n de PII]
      A --> F[LLMBackend (L√≥gica de Negocio)]
      F --> G[Proveedores LLM (OpenAI, Anthropic, Gemini)]
  ```

- **Flujo de datos principal entre componentes:**  
  1. El usuario accede a la aplicaci√≥n mediante el navegador y carga archivos (PDF o TXT).  
  2. Se valida cada archivo (por ejemplo, con `validate_file_size`) y se extrae el contenido textual usando `extract_text_from_pdf`.  
  3. El texto extra√≠do se env√≠a al m√≥dulo de parser, donde se normaliza la conversaci√≥n, se segmenta en turnos y se redacta la informaci√≥n sensible (PII).  
  4. La informaci√≥n normalizada se env√≠a al m√≥dulo LLMBackend, el cual ‚Äìmediante la configuraci√≥n entregada en ModelConfig‚Äì env√≠a el contenido a los proveedores LLM mediante un prompt (en este caso se utiliza el m√©todo de procesamiento en lote, `analyze_conversations_batch`) para obtener an√°lisis, insights, detecci√≥n de temas, sentimientos y recomendaciones.  
  5. Los resultados se almacenan en `st.session_state` y se visualizan de forma interactiva en la interfaz.

- **Dependencias cr√≠ticas y su prop√≥sito:**  
  - **Streamlit:** Proporciona la interfaz web interactiva y maneja el estado en tiempo real.  
  - **PyPDF2:** Extrae el contenido textual de los documentos PDF.  
  - **Pandas:** Facilita la manipulaci√≥n y visualizaci√≥n de datos tabulados, por ejemplo, para mostrar KPIs y tablas.  
  - **LLM SDKs (openai, anthropic, google-genai):** Permiten la integraci√≥n con diferentes proveedores de modelos de lenguaje para realizar an√°lisis sem√°ntico y generar insights.  
  - Otras librer√≠as est√°ndar (json, os, time, datetime, uuid, zipfile, io, typing) ofrecen utilidades b√°sicas y manejo de datos a lo largo de la aplicaci√≥n.

----------------------------------------------------------------
## üìã Stack Tecnol√≥gico

- **Lenguajes:**  
  - Principalmente Python (los archivos se clasifican como ‚Äúother‚Äù en el repositorio).

- **Frameworks / Librer√≠as:**  
  - **Streamlit:** (>= 1.49.1) para la creaci√≥n de la interfaz web interactiva.
  - **PyPDF2:** (>= 3.0.1) para extraer texto de documentos PDF.
  - **Pandas:** (>= 2.3.2) para manipular y visualizar datos (tablas, DataFrames, etc.).
  - **LLM SDKs:**
    - `openai` ‚Äì Para integrar modelos de OpenAI.
    - `anthropic` ‚Äì Para conectar con proveedores de Anthropic.
    - `google-genai` ‚Äì Para integrar modelos de Google GenAI (Gemini).
  - **Librer√≠as est√°ndar de Python:** json, os, time, datetime, uuid, zipfile, io, typing.

- **Base de Datos:**  
  No se utiliza una base de datos relacional. El almacenamiento es transitorio y se gestiona en memoria a trav√©s de `st.session_state`.

- **APIs externas:**  
  La aplicaci√≥n se conecta a las APIs de proveedores LLM (OpenAI, Anthropic y Google GenAI) para realizar an√°lisis de lenguaje e inteligencia artificial.

- **Infraestructura:**  
  La aplicaci√≥n se despliega como una aplicaci√≥n web simple con Streamlit y puede ejecutarse en entornos locales, servidores o contenedores Docker.

----------------------------------------------------------------
## üîß Componentes Principales

### 1. Aplicaci√≥n Streamlit

- **Prop√≥sito:**  
  Gestiona la interfaz de usuario final, permitiendo la carga, validaci√≥n y visualizaci√≥n de archivos y resultados de an√°lisis. Adem√°s, configura la p√°gina, maneja el estado de la sesi√≥n y coordina las interacciones con el backend.
  
- **Ubicaci√≥n:**  
  Principalmente en el archivo `app.py` (dentro de la carpeta `app/` o en la ra√≠z), junto a m√≥dulos auxiliares como `parser.py` y `utils.py`.

- **Interfaces y Funcionalidades:**  
  - **Configuraci√≥n de la P√°gina:** Se utiliza `st.set_page_config` para definir el t√≠tulo, el icono, el layout y la configuraci√≥n inicial del sidebar.  
  - **Gesti√≥n del Estado:**  
    Se utiliza `st.session_state` para almacenar variables clave como:
      - `analysis_results`: Resultados del an√°lisis ejecutado.
      - `run_id`: Identificador √∫nico para cada ejecuci√≥n.
      - `uploaded_files_data`: Informaci√≥n de los archivos subidos, en forma de lista de diccionarios.
      - `processing_complete`: Indicador booleano que marca la finalizaci√≥n del an√°lisis.
  - **Funciones Auxiliares de Carga y Procesamiento:**  
    - `extract_text_from_pdf(pdf_file) ‚Üí str`: Recorre el PDF, extrae el texto de cada p√°gina y retorna el contenido completo.  
    - `validate_file_size(file) ‚Üí bool`: Asegura que el archivo a procesar tenga un tama√±o inferior a 100MB.
  
- **Ejemplo de C√≥digo:**  
  (Se muestra en el bloque inicial de c√≥digo, donde se configuran las variables de sesi√≥n, se definen las funciones de extracci√≥n y validaci√≥n, y se configura la p√°gina con Streamlit).

---

### 2. M√≥dulo LLMBackend

- **Prop√≥sito:**  
  Integra la aplicaci√≥n con proveedores de modelos de lenguaje (LLM) para analizar el contenido textual extra√≠do y procesado. Permite configurar din√°micamente el proveedor y el modelo, cargar prompts espec√≠ficos y gestionar la comunicaci√≥n (incluyendo reintentos en caso de fallo).
  
- **Ubicaci√≥n:**  
  Se encuentra en el archivo `llm_backend.py` en la ra√≠z del proyecto.

- **Interfaces y Funcionalidades:**  
  - **ModelConfig:**  
    Una clase de configuraci√≥n (utilizando dataclasses) que define:
    - `provider`: El proveedor a utilizar (ej.: "openai", "anthropic" o "gemini").
    - `model`: El modelo espec√≠fico a emplear.
    - `api_key`: La clave API necesaria para la autenticaci√≥n.
    - `max_retries` y `retry_delay`: Par√°metros que permiten gestionar los reintentos en caso de error en la comunicaci√≥n.
    
  - **LLMBackend:**  
    M√©todos clave:
    - `__init__(config: ModelConfig)`: Inicializa el backend utilizando la configuraci√≥n especificada.
    - `_initialize_client()`: Selecciona y retorna la instancia del cliente del proveedor LLM adecuado.
    - `_load_parse_prompt()` y `_load_analyze_prompt()`: Preparan y configuran los prompts necesarios para el an√°lisis.  
    - `analyze_text(text: str) ‚Üí Dict[str, Any]`: Env√≠a el texto a analizar al proveedor LLM y retorna un diccionario con los resultados.  
    - En el ejemplo se utiliza adem√°s un m√©todo optimizado de procesamiento en lote con `analyze_conversations_batch(processed_files)`, que permite ejecutar el an√°lisis de m√∫ltiples archivos a la vez para mejorar el rendimiento.

---

### 3. Extracci√≥n y Procesamiento de Archivos

- **Prop√≥sito:**  
  Gestionar la carga y el procesamiento de archivos subidos. Esto incluye la validaci√≥n del tama√±o y el tipo de archivo, la extracci√≥n del contenido textual de archivos PDF (o archivos de texto planos), y la preparaci√≥n de los datos para el an√°lisis.
  
- **Funciones Clave:**  
  - `extract_text_from_pdf(pdf_file) ‚Üí str`: Extrae el texto concatenando el resultado de cada p√°gina del PDF y maneja excepciones en caso de error.
  - `validate_file_size(file) ‚Üí bool`: Comprueba que el archivo no exceda el l√≠mite de 100MB.
  - `process_uploaded_files(uploaded_files) ‚Üí List[Dict[str, Any]]`: Itera sobre cada archivo subido, valida su tama√±o y tipo, extrae el contenido y compila un listado de datos con el nombre del archivo, contenido, tama√±o y tipo.

---

### 4. Parser y An√°lisis de Conversaciones

- **Prop√≥sito:**  
  Transformar el contenido textual (extra√≠do de archivos o ingresado manualmente) en un formato estructurado para el an√°lisis.  
  Incluye la segmentaci√≥n del texto en turnos de conversaci√≥n, la identificaci√≥n de metadatos como timestamps y roles (cliente, agente, desconocido) y la redacci√≥n de la informaci√≥n sensible (PII) reemplaz√°ndola por etiquetas predefinidas (por ejemplo, `[EMAIL]`, `[PHONE]`).
  
- **Funcionalidades Espec√≠ficas:**  
  - Dividir y estructurar la conversaci√≥n en un objeto JSON.
  - Extraer e incorporar metadatos adicionales para mejorar el an√°lisis posterior.
  - Generar una salida homog√©nea para la visualizaci√≥n en paneles y la exportaci√≥n en formatos reutilizables.

----------------------------------------------------------------
## üöÄ APIs y Endpoints

Aunque la aplicaci√≥n no expone endpoints REST p√∫blicos, se definen ‚ÄúAPIs internas‚Äù en forma de funciones y m√©todos que orquestan el flujo completo del procesamiento:

- **Funci√≥n: extract_text_from_pdf(pdf_file) ‚Üí str:**  
  Extrae el contenido textual de un PDF utilizando PyPDF2 y gestiona errores mediante bloques try/except.

- **Funci√≥n: validate_file_size(file) ‚Üí bool:**  
  Verifica que el archivo subido tenga un tama√±o menor a 100MB mediante operaciones sobre el puntero del archivo.

- **M√©todo: LLMBackend.analyze_text(text: str) ‚Üí Dict[str, Any]:**  
  Env√≠a el texto (junto con un prompt de an√°lisis) al proveedor LLM configurado y retorna un diccionario con los insights, an√°lisis de sentimientos, temas y recomendaciones.

- **Funci√≥n de procesamiento en lote:**  
  El m√©todo `analyze_conversations_batch(processed_files)` (utilizado en el c√≥digo) permite enviar m√∫ltiples archivos a procesar en una sola llamada para mejorar la eficiencia.

- **Parser de Conversaciones:**  
  Funciones que transforman la entrada textual en un JSON estructurado, normalizando la informaci√≥n y protegiendo la PII.

----------------------------------------------------------------
## üíæ Modelo de Datos

- **Entidades Principales: Conversaci√≥n**  
  La informaci√≥n se estructura internamente en un formato JSON con los siguientes campos:
  - `conversation_id`: Identificador √∫nico, que puede derivarse del nombre del archivo o de metadatos.
  - `messages`: Lista de mensajes, donde cada mensaje incluye:
    - `sender`: El rol del emisor (cliente, agente o desconocido).
    - `timestamp`: La marca de tiempo del mensaje, si est√° disponible.
    - `content`: El texto del mensaje, con la informaci√≥n sensible ya redactada.
    - `metadata`: Informaci√≥n adicional, como canal de comunicaci√≥n o duraci√≥n del mensaje.
    
- **Esquemas de Entrada y Salida:**  
  - **Entrada:** Archivos PDF o archivos de texto (.txt) y transcripciones de conversaciones.  
  - **Salida:** JSON estructurado que incluye tanto el detalle de la conversaci√≥n como los insights generados (KPI, temas, recomendaciones, asignaciones de mensajes, etc.).

- **Validaciones y Transformaciones:**  
  - Se valida que el contenido extra√≠do sea no vac√≠o y est√© correctamente formateado.  
  - Se aplican reglas de redacci√≥n para anonimizar la informaci√≥n sensible (PII) antes de procesar el an√°lisis.  
  - Se estructura el JSON para que sea f√°cilmente consumible por los m√≥dulos de visualizaci√≥n y exportaci√≥n.

----------------------------------------------------------------
## üõ†Ô∏è Gu√≠a de Desarrollo

### 1. Configuraci√≥n del Entorno

1. **Prerrequisitos:**
   - Python 3.8 o superior.
   - Conexi√≥n a Internet para realizar llamadas a las APIs de proveedores LLM (en producci√≥n).

2. **Instalaci√≥n:**
   - Clona el repositorio:
     ```bash
     git clone https://github.com/tu_usuario/voc-analyst.git
     cd voc-analyst
     ```
   - Crea y activa un entorno virtual:
     ```bash
     python -m venv env
     source env/bin/activate       # En Linux/Mac
     env\Scripts\activate          # En Windows
     ```
   - Instala las dependencias:
     ```bash
     pip install -r requirements.txt
     ```

3. **Variables de Entorno:**
   - Configura las API keys mediante variables de entorno, por ejemplo:
     - `OPENAI_API_KEY`
     - `ANTHROPIC_API_KEY`
     - `GEMINI_API_KEY`

---

### 2. Estructura del C√≥digo

El repositorio se organiza de la siguiente manera:

```
VoC-Analyst/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ app.py                # Punto de entrada: Interfaz de usuario con Streamlit
‚îÇ   ‚îú‚îÄ‚îÄ parser.py             # Funciones de parseo y procesamiento de conversaciones
‚îÇ   ‚îî‚îÄ‚îÄ utils.py              # Funciones auxiliares (extracci√≥n de texto, validaci√≥n, etc.)
‚îú‚îÄ‚îÄ llm_backend.py            # M√≥dulo para integraci√≥n con proveedores LLM
‚îú‚îÄ‚îÄ requirements.txt          # Lista de dependencias
‚îî‚îÄ‚îÄ README.md                 # Documentaci√≥n general y gu√≠a de usuario
```

- **Convenciones de C√≥digo:**
  - Emplear nombres descriptivos en min√∫sculas y separados por guiones bajos.
  - Separar la l√≥gica de la interfaz (Streamlit) de la l√≥gica de negocio (LLMBackend y Parser).
  - Utilizar inyecci√≥n de dependencias a trav√©s de la clase `ModelConfig` para facilitar la extensi√≥n y mantenimiento.
  - Escribir pruebas unitarias (por ejemplo, con pytest) para funciones cr√≠ticas como la extracci√≥n de texto, validaci√≥n y comunicaci√≥n con el LLM.

- **Manejo de Errores y Logging:**
  - Utilizar bloques try/except en cada funci√≥n cr√≠tica para capturar y notificar errores.
  - Registrar eventos importantes mediante el m√≥dulo logging (opcional para futuras mejoras).

---

### 3. Pruebas y Validaci√≥n

- **Pruebas Unitarias:**
  - Implementar pruebas para:
    - Validar que `extract_text_from_pdf` extraiga correctamente el contenido.
    - Confirmar que `validate_file_size` funcione de acuerdo al l√≠mite permitido.
    - Simular peticiones al m√≥dulo LLMBackend y verificar el manejo correcto de respuestas y reintentos.
  
- **Validaci√≥n de Integraci√≥n:**
  - Asegurarse de que la cadena de flujo, desde la carga del archivo hasta la visualizaci√≥n de resultados, se ejecute correctamente.
  - Testear el m√©todo de procesamiento en lote (`analyze_conversations_batch`) para garantizar la escalabilidad.

---

## üîç Puntos de Atenci√≥n

- **Limitaciones Conocidas:**
  - La extracci√≥n de texto depende de la calidad de los archivos PDF. PDFs basados en im√°genes pueden requerir integrar OCR.
  - Los an√°lisis de modelos LLM dependen de la claridad del texto ingresado y de la configuraci√≥n correcta de la API key.
  - Actualmente, la aplicaci√≥n procesa un archivo o grupo de archivos en una ejecuci√≥n; el procesamiento as√≠ncrono o en lotes podr√≠a mejorar el rendimiento en futuros desarrollos.

- **Consideraciones de Rendimiento:**
  - El procesamiento de archivos muy grandes (cercanos a 100MB) puede afectar el tiempo de respuesta.
  - Se recomienda implementar t√©cnicas de caching o procesamiento en lote para an√°lisis repetitivos.

- **Aspectos de Seguridad:**
  - Las API keys deben protegerse utilizando variables de entorno y no deben exponerse en el c√≥digo fuente.
  - Es fundamental redactar (anonymizar) la informaci√≥n sensible (PII) antes de enviarla a proveedores externos.

- **TODOs y Mejoras Sugeridas:**
  - Ampliar el soporte a otros formatos de archivo (por ejemplo, TXT).
  - Integrar OCR para procesar PDFs basados en im√°genes.
  - Desarrollar procesamiento as√≠ncrono y/o en lote para mejorar el rendimiento en an√°lisis masivo.
  - Mejorar la modularidad del parser y la gesti√≥n de errores en la comunicaci√≥n con el LLM.

----------------------------------------------------------------
## Diagrama del Sistema

El siguiente diagrama Mermaid resume la interacci√≥n y flujo entre la interfaz de usuario, el m√≥dulo de procesamiento y el LLMBackend:

```mermaid
graph LR
    A[Interfaz Streamlit] --> B[Procesamiento y Validaci√≥n de Archivos]
    B --> C[Parser y Normalizaci√≥n de Conversaciones]
    A --> D[LLMBackend]
    D --> E[Proveedores LLM (OpenAI, Anthropic, Gemini)]
```

----------------------------------------------------------------
## Consideraciones Finales

- **Escalabilidad y Mantenimiento:**  
  La estructura modular permite agregar nuevos proveedores LLM, ampliar funcionalidades y adaptar el parser sin reescribir la interfaz.  
- **Documentaci√≥n y Colaboraci√≥n:**  
  Se recomienda mantener la documentaci√≥n actualizada conforme se realicen mejoras o se agreguen nuevos m√≥dulos.  
- **Seguridad y Privacidad:**  
  Se debe prestar atenci√≥n a la protecci√≥n de API keys y la redacci√≥n adecuada de PII para cumplir con las pol√≠ticas de privacidad y normativas vigentes.

----------------------------------------------------------------
## Gu√≠a de Usuario ‚Äì Resumen Pr√°ctico

1. **Acceso a la Aplicaci√≥n:**  
   Abra su navegador y dir√≠jase a la URL designada (ejemplo: http://localhost:8501).  
2. **Carga de Archivos:**  
   Utilice la opci√≥n ‚ÄúCargar PDF‚Äù o ‚ÄúSubir Archivo‚Äù para cargar documentos o transcripciones.
3. **Ejecuci√≥n del An√°lisis:**  
   Una vez procesados, haga clic en ‚ÄúAnalizar con LLM‚Äù para enviar el contenido a los modelos de lenguaje y generar an√°lisis e insights.
4. **Visualizaci√≥n y Exportaci√≥n:**  
   Revise los paneles de resultados (KPIs, Temas, Recomendaciones, Asignaciones) y use las opciones de exportaci√≥n (descargar JSON o CSV) para obtener los datos.
5. **Soporte:**  
   Para ayuda adicional, revise la secci√≥n de Preguntas Frecuentes o contacte al equipo de soporte mediante los datos proporcionados en la aplicaci√≥n.

----------------------------------------------------------------
## Diagrama Final

```mermaid
graph LR
App[app] --> Deps[dependencies]
```

----------------------------------------------------------------
Happy Coding y ¬°√©xito en el an√°lisis de la Voz del Cliente!

Para cualquier duda, sugerencia o contribuci√≥n, se recomienda revisar el repositorio de issues o contactar directamente al equipo de desarrollo.

----------------------------------------------------------------
## Diagrama (Resumen Visual)

```mermaid
graph LR
App["app"] --> Deps["dependencies"]
```


## Diagrama
```mermaid
graph LR\nApp["app"]-->Deps["dependencies"]\n
```
