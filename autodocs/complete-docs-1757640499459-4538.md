# DocumentaciÃ³n del Proyecto

## GuÃ­a de Usuario
# GuÃ­a de Usuario

Bienvenido a la herramienta de anÃ¡lisis y procesamiento de informaciÃ³n. Esta aplicaciÃ³n te ayudarÃ¡ a transformar grandes volÃºmenes de datos en insights claros y accionables a travÃ©s de una interfaz web amigable.

---

## ğŸ“± Â¿QuÃ© es esta aplicaciÃ³n?

- **PropÃ³sito principal:**  
  Esta herramienta permite analizar informaciÃ³n contenida en archivos PDF, conversaciones y datos de Voz del Cliente (VoC) de forma interactiva. Utiliza modelos de lenguaje basados en IA para interpretar y extraer datos relevantes, facilitando el entendimiento y la toma de decisiones.

- **Problema que resuelve:**  
  Si necesitas extraer conocimientos de informes extensos, analizar diÃ¡logos o entender las opiniones y comentarios de tus clientes, nuestra aplicaciÃ³n automatiza estas tareas para ahorrarte tiempo y reducir errores en la interpretaciÃ³n manual.

- **Beneficios clave:**  
  â€¢ Ahorro de tiempo gracias a procesos automÃ¡ticos.  
  â€¢ Resultados claros y visuales que facilitan la toma de decisiones.  
  â€¢ Soporte para mÃºltiples tipos de anÃ¡lisis: documentos, conversaciones y feedback de clientes.  
  â€¢ Acceso a insights que pueden potenciar estrategias de negocio y atenciÃ³n al cliente.

- **Audiencia objetivo:**  
  Profesionales en Ã¡reas de anÃ¡lisis de datos, atenciÃ³n al cliente, marketing, investigaciÃ³n de mercado y equipos de soporte que necesiten transformar grandes volÃºmenes de informaciÃ³n en datos Ãºtiles.

---

## âœ¨ Funcionalidades Principales

### Interfaz Web Interactiva
- **Â¿QuÃ© hace?**  
  Ofrece un entorno visual y fÃ¡cil de usar donde puedes navegar entre las diferentes funcionalidades de la aplicaciÃ³n, subir archivos, configurar anÃ¡lisis y visualizar resultados en tiempo real.

- **Â¿CuÃ¡ndo usarla?**  
  Cada vez que necesites acceder a la herramienta, revisar resultados o configurar un nuevo anÃ¡lisis, la interfaz actÃºa como tu punto de entrada principal.

- **Â¿CÃ³mo acceder?**  
  Simplemente abre tu navegador y dirÃ­gete a la URL proporcionada. Una vez cargada, encontrarÃ¡s un menÃº claro para navegar entre las opciones disponibles.

- **Resultado esperado:**  
  Una pantalla limpia con opciones de menÃº, botones y paneles de visualizaciÃ³n que te permiten interactuar fÃ¡cilmente con la aplicaciÃ³n.

### Procesamiento de Archivos PDF
- **Â¿QuÃ© hace?**  
  Permite cargar archivos PDF para extraer y procesar su contenido textual de manera automÃ¡tica, listo para ser analizado.

- **Â¿CuÃ¡ndo usarla?**  
  Ãšsala cuando necesites analizar reportes, documentos o cualquier otro archivo PDF que contenga informaciÃ³n relevante.

- **Â¿CÃ³mo acceder?**  
  En la interfaz principal, selecciona la opciÃ³n "Procesar PDF", luego arrastra y suelta tu archivo o haz clic para buscarlo en tu ordenador.

- **Resultado esperado:**  
  Una vista previa del contenido del documento extraÃ­do y listo para someterlo a anÃ¡lisis con modelos de lenguaje.

### AnÃ¡lisis con Modelos de Lenguaje (IA)
- **Â¿QuÃ© hace?**  
  Utiliza algoritmos de inteligencia artificial para interpretar el contenido textual, identificar patrones y extraer insights valiosos.

- **Â¿CuÃ¡ndo usarla?**  
  Ideal para analizar grandes volÃºmenes de texto cuando buscas extraer informaciÃ³n especÃ­fica, generar resÃºmenes o obtener recomendaciones basadas en el contenido.

- **Â¿CÃ³mo acceder?**  
  Tras procesar un archivo o ingresar un texto, selecciona la opciÃ³n "Analizar con IA" y sigue las indicaciones en pantalla.

- **Resultado esperado:**  
  Un reporte detallado con insights, clasificaciones y sugerencias basadas en los datos analizados.

### AnÃ¡lisis de Conversaciones
- **Â¿QuÃ© hace?**  
  Permite cargar transcripciones o registros de conversaciones (como chats o llamadas) para analizarlas y extraer temas recurrentes y sentiment analysis.

- **Â¿CuÃ¡ndo usarla?**  
  Cuando necesites entender el flujo de las conversaciones de soporte, detectar problemas recurrentes o medir el tono general de las interacciones.

- **Â¿CÃ³mo acceder?**  
  Desde la interfaz, elige la secciÃ³n "AnÃ¡lisis de Conversaciones", carga tus archivos o pega el texto y activa el proceso de anÃ¡lisis.

- **Resultado esperado:**  
  Visualizaciones y reportes que muestran los temas predominantes, la frecuencia de palabras clave y anÃ¡lisis de sentimientos.

### AnÃ¡lisis de Voz del Cliente (VoC)
- **Â¿QuÃ© hace?**  
  EvalÃºa comentarios, reseÃ±as y feedback de clientes, permitiendo identificar tendencias, niveles de satisfacciÃ³n y Ã¡reas de mejora.

- **Â¿CuÃ¡ndo usarla?**  
  Ãšsala cuando desees conocer en profundidad la opiniÃ³n de tus clientes para mejorar productos, servicios o procesos internos.

- **Â¿CÃ³mo acceder?**  
  En el menÃº, selecciona "Voz del Cliente (VoC)", sube los archivos o introduce los comentarios y empieza el anÃ¡lisis.

- **Resultado esperado:**  
  Un informe enfocado en las percepciones del cliente, destacando opiniones positivas, crÃ­ticas y sugerencias de mejora.

---

## ğŸš€ CÃ³mo Empezar

### Primer Uso
1. **Requisitos previos:**  
   - Una conexiÃ³n estable a Internet.  
   - Un navegador web actualizado.  
   - Archivos PDF o textos de conversaciones/listados de feedback (si aplica).
2. **Acceso inicial:**  
   Ingresa a la aplicaciÃ³n usando la URL proporcionada. La pÃ¡gina de inicio te darÃ¡ la bienvenida y mostrarÃ¡ las opciones principales.
3. **ConfiguraciÃ³n bÃ¡sica:**  
   Revisa la configuraciÃ³n de idioma y visualizaciÃ³n. No es necesaria una configuraciÃ³n avanzada, la aplicaciÃ³n estÃ¡ lista para usar.
4. **Primera tarea recomendada:**  
   Sube un archivo PDF y realiza un anÃ¡lisis bÃ¡sico para familiarizarte con la interfaz y el proceso de extracciÃ³n de informaciÃ³n.

### Flujo TÃ­pico de Uso
1. **Paso 1:**  
   Accede a la interfaz web mediante tu navegador.
2. **Paso 2:**  
   Selecciona la funcionalidad deseada (por ejemplo, "Procesar PDF" o "AnÃ¡lisis de Conversaciones").
3. **Paso 3:**  
   Sube el archivo o ingresa el texto, y luego activa el anÃ¡lisis.
4. **Paso 4:**  
   Visualiza el reporte generado, explora los insights y, si es necesario, ajusta los parÃ¡metros del anÃ¡lisis para afinar los resultados.

---

## ğŸ’¡ Casos de Uso Comunes

### Escenario 1: AnÃ¡lisis de Reportes en PDF
**SituaciÃ³n:**  
Necesitas extraer informaciÃ³n clave de un informe extenso para presentar insights a tu equipo.

**Pasos:**  
1. Ingresa a la aplicaciÃ³n y selecciona "Procesar PDF".  
2. Sube el informe en formato PDF.  
3. Activa el anÃ¡lisis con IA para resumir y resaltar puntos importantes.  
4. Revisa el informe generado y utiliza la informaciÃ³n para preparar tu presentaciÃ³n.

### Escenario 2: EvaluaciÃ³n de Conversaciones de Soporte
**SituaciÃ³n:**  
Quieres identificar temas comunes y detectar Ã¡reas de mejora en las interacciones de soporte al cliente.

**Pasos:**  
1. Accede a "AnÃ¡lisis de Conversaciones".  
2. Carga las transcripciones de chats o registros de llamadas.  
3. Ejecuta el anÃ¡lisis y observa las visualizaciones y resÃºmenes.  
4. Usa los resultados para capacitar a tu equipo y optimizar procesos.

### Escenario 3: RevisiÃ³n de la Voz del Cliente (VoC)
**SituaciÃ³n:**  
Deseas conocer la percepciÃ³n de tus clientes acerca de un nuevo producto o servicio.

**Pasos:**  
1. Selecciona "Voz del Cliente (VoC)" en la interfaz.  
2. Sube los comentarios, encuestas o reseÃ±as de clientes.  
3. Inicia el anÃ¡lisis y espera a que se generen los insights.  
4. Analiza el feedback para descubrir tendencias y Ã¡reas a mejorar.

---

## â“ Preguntas Frecuentes

**P: Â¿CÃ³mo puedo cargar un archivo PDF para su anÃ¡lisis?**  
R: Simplemente dirÃ­gete a la secciÃ³n "Procesar PDF", arrastra y suelta el archivo o haz clic para seleccionarlo desde tu dispositivo.

**P: Â¿QuÃ© hago si el anÃ¡lisis tarda demasiado en completarse?**  
R: Verifica tu conexiÃ³n a Internet y asegÃºrate de que el archivo no sea excesivamente grande. Si el problema persiste, reinicia el proceso o contacta al soporte.

**P: Â¿Es seguro usar la herramienta con datos confidenciales?**  
R: SÃ­, la aplicaciÃ³n aplica medidas de seguridad bÃ¡sicas para proteger la informaciÃ³n. Sin embargo, te recomendamos evitar cargar documentos altamente sensibles o confidenciales.

**P: Â¿CuÃ¡les son las limitaciones principales de la aplicaciÃ³n?**  
R: La herramienta estÃ¡ optimizada para formatos de texto comunes. Puede tener dificultades con documentos escaneados sin reconocimiento Ã³ptico (OCR) o con formatos de archivos no soportados. AdemÃ¡s, la precisiÃ³n del anÃ¡lisis dependerÃ¡ de la calidad del texto subido.

---

## ğŸ†˜ SoluciÃ³n de Problemas

### Problema: Error al Cargar un Archivo PDF
**SÃ­ntomas:**  
El archivo no se sube o aparece un mensaje de error durante la carga.

**Causa probable:**  
El archivo puede estar daÃ±ado, ser incompatible o exceder el tamaÃ±o permitido.

**SoluciÃ³n:**  
1. Verifica que el PDF se abra correctamente en otro visor.  
2. AsegÃºrate de que cumple con los requisitos de formato y tamaÃ±o.  
3. Intenta disminuir el tamaÃ±o o convertir el archivo y vuelve a intentarlo.

### Problema: Resultados Inesperados en el AnÃ¡lisis de Conversaciones
**SÃ­ntomas:**  
El reporte no muestra temas definidos o los insights parecen confusos.

**Causa probable:**  
El texto podrÃ­a contener errores, estar mal estructurado o tener un formato inusual.

**SoluciÃ³n:**  
1. Revisa la calidad del texto cargado y corrige posibles errores de transcripciÃ³n.  
2. AsegÃºrate de que las conversaciones estÃ©n bien delimitadas (por ejemplo, identificadores de interlocutores).  
3. Ejecuta nuevamente el proceso de anÃ¡lisis.

### Problema: Lentitud en la VisualizaciÃ³n de Resultados
**SÃ­ntomas:**  
El anÃ¡lisis tarda mÃ¡s de lo esperado o la interfaz responde lentamente.

**Causa probable:**  
Puede ser un problema de conexiÃ³n a Internet o una gran cantidad de datos a procesar.

**SoluciÃ³n:**  
1. Comprueba tu conexiÃ³n a Internet.  
2. Intenta realizar el anÃ¡lisis en momentos de menor actividad.  
3. Si el problema persiste, contacta al soporte indicando el problema.

---

## ğŸ“ Soporte y Contacto
- **Â¿Necesitas ayuda adicional?**  
  ComunÃ­cate con nuestro equipo de soporte al correo soporte@tuempresa.com.
- **Â¿Encontraste un error?**  
  Reporta cualquier fallo o comportamiento inesperado a travÃ©s del formulario de feedback disponible en la herramienta.
- **Â¿Tienes sugerencias?**  
  Nos encantarÃ­a saber cÃ³mo podemos mejorar. EnvÃ­a tus ideas y comentarios a feedback@tuempresa.com.

---

Esperamos que esta guÃ­a te sea Ãºtil para aprovechar al mÃ¡ximo la aplicaciÃ³n. Â¡Disfruta del anÃ¡lisis y la extracciÃ³n de insights de forma sencilla y eficiente!

## DocumentaciÃ³n TÃ©cnica
A continuaciÃ³n se presenta la documentaciÃ³n tÃ©cnica completa en Markdown, siguiendo la estructura solicitada y basada en el anÃ¡lisis del cÃ³digo proporcionado.

----------------------------------------------------------------
# DocumentaciÃ³n TÃ©cnica

Esta documentaciÃ³n estÃ¡ orientada a desarrolladores y equipos tÃ©cnicos interesados en comprender, mantener y extender la aplicaciÃ³n VoC Analyst. Esta herramienta permite procesar archivos (PDF y TXT), extraer y normalizar informaciÃ³n de conversaciones y, a travÃ©s de la integraciÃ³n con proveedores de modelos de lenguaje (LLM), generar insights sobre la Voz del Cliente (VoC). La interfaz se implementa con Streamlit y el procesamiento se realiza en un Ãºnico mÃ³dulo monolÃ­tico con responsabilidades bien definidas.

----------------------------------------------------------------
## ğŸ—ï¸ Arquitectura del Sistema

- **PatrÃ³n arquitectÃ³nico utilizado:**  
  La aplicaciÃ³n sigue un enfoque modular monolÃ­tico â€œhÃ­bridoâ€ en el que se integran la interfaz de usuario (Frontend) con la lÃ³gica de negocio (Backend).  
  - La **Capa de PresentaciÃ³n** se implementa con Streamlit, y es responsable de la carga de archivos, manejo de la interacciÃ³n y visualizaciÃ³n dinÃ¡mica de resultados.  
  - La **Capa de LÃ³gica y AnÃ¡lisis** se compone de mÃ³dulos para la extracciÃ³n y validaciÃ³n de archivos (por ejemplo, utilizando PyPDF2 para extraer texto), el parsing y normalizaciÃ³n de conversaciones (incluyendo redacciÃ³n de PII) y la integraciÃ³n con proveedores de Modelos de Lenguaje (LLM) a travÃ©s del mÃ³dulo LLMBackend.

- **Diagrama de componentes:**  
  A continuaciÃ³n se muestra un diagrama Mermaid que resume la estructura del sistema:

  ```mermaid
  graph LR
      A[Interfaz Streamlit (Frontend)] --> B[Procesamiento y ValidaciÃ³n de Archivos]
      A --> C[GestiÃ³n del Estado (st.session_state)]
      B --> D[ExtracciÃ³n de Texto (PyPDF2)]
      B --> E[Parser y RedacciÃ³n de PII]
      A --> F[LLMBackend (LÃ³gica de Negocio)]
      F --> G[Proveedores LLM (OpenAI, Anthropic, Gemini)]
  ```

- **Flujo de datos principal entre componentes:**  
  1. El usuario accede a la aplicaciÃ³n mediante el navegador y carga archivos (PDF o TXT).  
  2. Se valida cada archivo (por ejemplo, con `validate_file_size`) y se extrae el contenido textual usando `extract_text_from_pdf`.  
  3. El texto extraÃ­do se envÃ­a al mÃ³dulo de parser, donde se normaliza la conversaciÃ³n, se segmenta en turnos y se redacta la informaciÃ³n sensible (PII).  
  4. La informaciÃ³n normalizada se envÃ­a al mÃ³dulo LLMBackend, el cual â€“mediante la configuraciÃ³n entregada en ModelConfigâ€“ envÃ­a el contenido a los proveedores LLM mediante un prompt (en este caso se utiliza el mÃ©todo de procesamiento en lote, `analyze_conversations_batch`) para obtener anÃ¡lisis, insights, detecciÃ³n de temas, sentimientos y recomendaciones.  
  5. Los resultados se almacenan en `st.session_state` y se visualizan de forma interactiva en la interfaz.

- **Dependencias crÃ­ticas y su propÃ³sito:**  
  - **Streamlit:** Proporciona la interfaz web interactiva y maneja el estado en tiempo real.  
  - **PyPDF2:** Extrae el contenido textual de los documentos PDF.  
  - **Pandas:** Facilita la manipulaciÃ³n y visualizaciÃ³n de datos tabulados, por ejemplo, para mostrar KPIs y tablas.  
  - **LLM SDKs (openai, anthropic, google-genai):** Permiten la integraciÃ³n con diferentes proveedores de modelos de lenguaje para realizar anÃ¡lisis semÃ¡ntico y generar insights.  
  - Otras librerÃ­as estÃ¡ndar (json, os, time, datetime, uuid, zipfile, io, typing) ofrecen utilidades bÃ¡sicas y manejo de datos a lo largo de la aplicaciÃ³n.

----------------------------------------------------------------
## ğŸ“‹ Stack TecnolÃ³gico

- **Lenguajes:**  
  - Principalmente Python (los archivos se clasifican como â€œotherâ€ en el repositorio).

- **Frameworks / LibrerÃ­as:**  
  - **Streamlit:** (>= 1.49.1) para la creaciÃ³n de la interfaz web interactiva.
  - **PyPDF2:** (>= 3.0.1) para extraer texto de documentos PDF.
  - **Pandas:** (>= 2.3.2) para manipular y visualizar datos (tablas, DataFrames, etc.).
  - **LLM SDKs:**
    - `openai` â€“ Para integrar modelos de OpenAI.
    - `anthropic` â€“ Para conectar con proveedores de Anthropic.
    - `google-genai` â€“ Para integrar modelos de Google GenAI (Gemini).
  - **LibrerÃ­as estÃ¡ndar de Python:** json, os, time, datetime, uuid, zipfile, io, typing.

- **Base de Datos:**  
  No se utiliza una base de datos relacional. El almacenamiento es transitorio y se gestiona en memoria a travÃ©s de `st.session_state`.

- **APIs externas:**  
  La aplicaciÃ³n se conecta a las APIs de proveedores LLM (OpenAI, Anthropic y Google GenAI) para realizar anÃ¡lisis de lenguaje e inteligencia artificial.

- **Infraestructura:**  
  La aplicaciÃ³n se despliega como una aplicaciÃ³n web simple con Streamlit y puede ejecutarse en entornos locales, servidores o contenedores Docker.

----------------------------------------------------------------
## ğŸ”§ Componentes Principales

### 1. AplicaciÃ³n Streamlit

- **PropÃ³sito:**  
  Gestiona la interfaz de usuario final, permitiendo la carga, validaciÃ³n y visualizaciÃ³n de archivos y resultados de anÃ¡lisis. AdemÃ¡s, configura la pÃ¡gina, maneja el estado de la sesiÃ³n y coordina las interacciones con el backend.
  
- **UbicaciÃ³n:**  
  Principalmente en el archivo `app.py` (dentro de la carpeta `app/` o en la raÃ­z), junto a mÃ³dulos auxiliares como `parser.py` y `utils.py`.

- **Interfaces y Funcionalidades:**  
  - **ConfiguraciÃ³n de la PÃ¡gina:** Se utiliza `st.set_page_config` para definir el tÃ­tulo, el icono, el layout y la configuraciÃ³n inicial del sidebar.  
  - **GestiÃ³n del Estado:**  
    Se utiliza `st.session_state` para almacenar variables clave como:
      - `analysis_results`: Resultados del anÃ¡lisis ejecutado.
      - `run_id`: Identificador Ãºnico para cada ejecuciÃ³n.
      - `uploaded_files_data`: InformaciÃ³n de los archivos subidos, en forma de lista de diccionarios.
      - `processing_complete`: Indicador booleano que marca la finalizaciÃ³n del anÃ¡lisis.
  - **Funciones Auxiliares de Carga y Procesamiento:**  
    - `extract_text_from_pdf(pdf_file) â†’ str`: Recorre el PDF, extrae el texto de cada pÃ¡gina y retorna el contenido completo.  
    - `validate_file_size(file) â†’ bool`: Asegura que el archivo a procesar tenga un tamaÃ±o inferior a 100MB.
  
- **Ejemplo de CÃ³digo:**  
  (Se muestra en el bloque inicial de cÃ³digo, donde se configuran las variables de sesiÃ³n, se definen las funciones de extracciÃ³n y validaciÃ³n, y se configura la pÃ¡gina con Streamlit).

---

### 2. MÃ³dulo LLMBackend

- **PropÃ³sito:**  
  Integra la aplicaciÃ³n con proveedores de modelos de lenguaje (LLM) para analizar el contenido textual extraÃ­do y procesado. Permite configurar dinÃ¡micamente el proveedor y el modelo, cargar prompts especÃ­ficos y gestionar la comunicaciÃ³n (incluyendo reintentos en caso de fallo).
  
- **UbicaciÃ³n:**  
  Se encuentra en el archivo `llm_backend.py` en la raÃ­z del proyecto.

- **Interfaces y Funcionalidades:**  
  - **ModelConfig:**  
    Una clase de configuraciÃ³n (utilizando dataclasses) que define:
    - `provider`: El proveedor a utilizar (ej.: "openai", "anthropic" o "gemini").
    - `model`: El modelo especÃ­fico a emplear.
    - `api_key`: La clave API necesaria para la autenticaciÃ³n.
    - `max_retries` y `retry_delay`: ParÃ¡metros que permiten gestionar los reintentos en caso de error en la comunicaciÃ³n.
    
  - **LLMBackend:**  
    MÃ©todos clave:
    - `__init__(config: ModelConfig)`: Inicializa el backend utilizando la configuraciÃ³n especificada.
    - `_initialize_client()`: Selecciona y retorna la instancia del cliente del proveedor LLM adecuado.
    - `_load_parse_prompt()` y `_load_analyze_prompt()`: Preparan y configuran los prompts necesarios para el anÃ¡lisis.  
    - `analyze_text(text: str) â†’ Dict[str, Any]`: EnvÃ­a el texto a analizar al proveedor LLM y retorna un diccionario con los resultados.  
    - En el ejemplo se utiliza ademÃ¡s un mÃ©todo optimizado de procesamiento en lote con `analyze_conversations_batch(processed_files)`, que permite ejecutar el anÃ¡lisis de mÃºltiples archivos a la vez para mejorar el rendimiento.

---

### 3. ExtracciÃ³n y Procesamiento de Archivos

- **PropÃ³sito:**  
  Gestionar la carga y el procesamiento de archivos subidos. Esto incluye la validaciÃ³n del tamaÃ±o y el tipo de archivo, la extracciÃ³n del contenido textual de archivos PDF (o archivos de texto planos), y la preparaciÃ³n de los datos para el anÃ¡lisis.
  
- **Funciones Clave:**  
  - `extract_text_from_pdf(pdf_file) â†’ str`: Extrae el texto concatenando el resultado de cada pÃ¡gina del PDF y maneja excepciones en caso de error.
  - `validate_file_size(file) â†’ bool`: Comprueba que el archivo no exceda el lÃ­mite de 100MB.
  - `process_uploaded_files(uploaded_files) â†’ List[Dict[str, Any]]`: Itera sobre cada archivo subido, valida su tamaÃ±o y tipo, extrae el contenido y compila un listado de datos con el nombre del archivo, contenido, tamaÃ±o y tipo.

---

### 4. Parser y AnÃ¡lisis de Conversaciones

- **PropÃ³sito:**  
  Transformar el contenido textual (extraÃ­do de archivos o ingresado manualmente) en un formato estructurado para el anÃ¡lisis.  
  Incluye la segmentaciÃ³n del texto en turnos de conversaciÃ³n, la identificaciÃ³n de metadatos como timestamps y roles (cliente, agente, desconocido) y la redacciÃ³n de la informaciÃ³n sensible (PII) reemplazÃ¡ndola por etiquetas predefinidas (por ejemplo, `[EMAIL]`, `[PHONE]`).
  
- **Funcionalidades EspecÃ­ficas:**  
  - Dividir y estructurar la conversaciÃ³n en un objeto JSON.
  - Extraer e incorporar metadatos adicionales para mejorar el anÃ¡lisis posterior.
  - Generar una salida homogÃ©nea para la visualizaciÃ³n en paneles y la exportaciÃ³n en formatos reutilizables.

----------------------------------------------------------------
## ğŸš€ APIs y Endpoints

Aunque la aplicaciÃ³n no expone endpoints REST pÃºblicos, se definen â€œAPIs internasâ€ en forma de funciones y mÃ©todos que orquestan el flujo completo del procesamiento:

- **FunciÃ³n: extract_text_from_pdf(pdf_file) â†’ str:**  
  Extrae el contenido textual de un PDF utilizando PyPDF2 y gestiona errores mediante bloques try/except.

- **FunciÃ³n: validate_file_size(file) â†’ bool:**  
  Verifica que el archivo subido tenga un tamaÃ±o menor a 100MB mediante operaciones sobre el puntero del archivo.

- **MÃ©todo: LLMBackend.analyze_text(text: str) â†’ Dict[str, Any]:**  
  EnvÃ­a el texto (junto con un prompt de anÃ¡lisis) al proveedor LLM configurado y retorna un diccionario con los insights, anÃ¡lisis de sentimientos, temas y recomendaciones.

- **FunciÃ³n de procesamiento en lote:**  
  El mÃ©todo `analyze_conversations_batch(processed_files)` (utilizado en el cÃ³digo) permite enviar mÃºltiples archivos a procesar en una sola llamada para mejorar la eficiencia.

- **Parser de Conversaciones:**  
  Funciones que transforman la entrada textual en un JSON estructurado, normalizando la informaciÃ³n y protegiendo la PII.

----------------------------------------------------------------
## ğŸ’¾ Modelo de Datos

- **Entidades Principales: ConversaciÃ³n**  
  La informaciÃ³n se estructura internamente en un formato JSON con los siguientes campos:
  - `conversation_id`: Identificador Ãºnico, que puede derivarse del nombre del archivo o de metadatos.
  - `messages`: Lista de mensajes, donde cada mensaje incluye:
    - `sender`: El rol del emisor (cliente, agente o desconocido).
    - `timestamp`: La marca de tiempo del mensaje, si estÃ¡ disponible.
    - `content`: El texto del mensaje, con la informaciÃ³n sensible ya redactada.
    - `metadata`: InformaciÃ³n adicional, como canal de comunicaciÃ³n o duraciÃ³n del mensaje.
    
- **Esquemas de Entrada y Salida:**  
  - **Entrada:** Archivos PDF o archivos de texto (.txt) y transcripciones de conversaciones.  
  - **Salida:** JSON estructurado que incluye tanto el detalle de la conversaciÃ³n como los insights generados (KPI, temas, recomendaciones, asignaciones de mensajes, etc.).

- **Validaciones y Transformaciones:**  
  - Se valida que el contenido extraÃ­do sea no vacÃ­o y estÃ© correctamente formateado.  
  - Se aplican reglas de redacciÃ³n para anonimizar la informaciÃ³n sensible (PII) antes de procesar el anÃ¡lisis.  
  - Se estructura el JSON para que sea fÃ¡cilmente consumible por los mÃ³dulos de visualizaciÃ³n y exportaciÃ³n.

----------------------------------------------------------------
## ğŸ› ï¸ GuÃ­a de Desarrollo

### 1. ConfiguraciÃ³n del Entorno

1. **Prerrequisitos:**
   - Python 3.8 o superior.
   - ConexiÃ³n a Internet para realizar llamadas a las APIs de proveedores LLM (en producciÃ³n).

2. **InstalaciÃ³n:**
   - Clona el repositorio:
     ```bash
     git clone https://github.com/tu_usuario/voc-analyst.git
     cd voc-analyst
     ```
   - Crea y activa un entorno virtual:
     ```bash
     python -m venv env
     source env/bin/activate       # En Linux/Mac
     env\Scripts\activate          # En Windows
     ```
   - Instala las dependencias:
     ```bash
     pip install -r requirements.txt
     ```

3. **Variables de Entorno:**
   - Configura las API keys mediante variables de entorno, por ejemplo:
     - `OPENAI_API_KEY`
     - `ANTHROPIC_API_KEY`
     - `GEMINI_API_KEY`

---

### 2. Estructura del CÃ³digo

El repositorio se organiza de la siguiente manera:

```
VoC-Analyst/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ app.py                # Punto de entrada: Interfaz de usuario con Streamlit
â”‚   â”œâ”€â”€ parser.py             # Funciones de parseo y procesamiento de conversaciones
â”‚   â””â”€â”€ utils.py              # Funciones auxiliares (extracciÃ³n de texto, validaciÃ³n, etc.)
â”œâ”€â”€ llm_backend.py            # MÃ³dulo para integraciÃ³n con proveedores LLM
â”œâ”€â”€ requirements.txt          # Lista de dependencias
â””â”€â”€ README.md                 # DocumentaciÃ³n general y guÃ­a de usuario
```

- **Convenciones de CÃ³digo:**
  - Emplear nombres descriptivos en minÃºsculas y separados por guiones bajos.
  - Separar la lÃ³gica de la interfaz (Streamlit) de la lÃ³gica de negocio (LLMBackend y Parser).
  - Utilizar inyecciÃ³n de dependencias a travÃ©s de la clase `ModelConfig` para facilitar la extensiÃ³n y mantenimiento.
  - Escribir pruebas unitarias (por ejemplo, con pytest) para funciones crÃ­ticas como la extracciÃ³n de texto, validaciÃ³n y comunicaciÃ³n con el LLM.

- **Manejo de Errores y Logging:**
  - Utilizar bloques try/except en cada funciÃ³n crÃ­tica para capturar y notificar errores.
  - Registrar eventos importantes mediante el mÃ³dulo logging (opcional para futuras mejoras).

---

### 3. Pruebas y ValidaciÃ³n

- **Pruebas Unitarias:**
  - Implementar pruebas para:
    - Validar que `extract_text_from_pdf` extraiga correctamente el contenido.
    - Confirmar que `validate_file_size` funcione de acuerdo al lÃ­mite permitido.
    - Simular peticiones al mÃ³dulo LLMBackend y verificar el manejo correcto de respuestas y reintentos.
  
- **ValidaciÃ³n de IntegraciÃ³n:**
  - Asegurarse de que la cadena de flujo, desde la carga del archivo hasta la visualizaciÃ³n de resultados, se ejecute correctamente.
  - Testear el mÃ©todo de procesamiento en lote (`analyze_conversations_batch`) para garantizar la escalabilidad.

---

## ğŸ” Puntos de AtenciÃ³n

- **Limitaciones Conocidas:**
  - La extracciÃ³n de texto depende de la calidad de los archivos PDF. PDFs basados en imÃ¡genes pueden requerir integrar OCR.
  - Los anÃ¡lisis de modelos LLM dependen de la claridad del texto ingresado y de la configuraciÃ³n correcta de la API key.
  - Actualmente, la aplicaciÃ³n procesa un archivo o grupo de archivos en una ejecuciÃ³n; el procesamiento asÃ­ncrono o en lotes podrÃ­a mejorar el rendimiento en futuros desarrollos.

- **Consideraciones de Rendimiento:**
  - El procesamiento de archivos muy grandes (cercanos a 100MB) puede afectar el tiempo de respuesta.
  - Se recomienda implementar tÃ©cnicas de caching o procesamiento en lote para anÃ¡lisis repetitivos.

- **Aspectos de Seguridad:**
  - Las API keys deben protegerse utilizando variables de entorno y no deben exponerse en el cÃ³digo fuente.
  - Es fundamental redactar (anonymizar) la informaciÃ³n sensible (PII) antes de enviarla a proveedores externos.

- **TODOs y Mejoras Sugeridas:**
  - Ampliar el soporte a otros formatos de archivo (por ejemplo, TXT).
  - Integrar OCR para procesar PDFs basados en imÃ¡genes.
  - Desarrollar procesamiento asÃ­ncrono y/o en lote para mejorar el rendimiento en anÃ¡lisis masivo.
  - Mejorar la modularidad del parser y la gestiÃ³n de errores en la comunicaciÃ³n con el LLM.

----------------------------------------------------------------
## Diagrama del Sistema

El siguiente diagrama Mermaid resume la interacciÃ³n y flujo entre la interfaz de usuario, el mÃ³dulo de procesamiento y el LLMBackend:

```mermaid
graph LR
    A[Interfaz Streamlit] --> B[Procesamiento y ValidaciÃ³n de Archivos]
    B --> C[Parser y NormalizaciÃ³n de Conversaciones]
    A --> D[LLMBackend]
    D --> E[Proveedores LLM (OpenAI, Anthropic, Gemini)]
```

----------------------------------------------------------------
## Consideraciones Finales

- **Escalabilidad y Mantenimiento:**  
  La estructura modular permite agregar nuevos proveedores LLM, ampliar funcionalidades y adaptar el parser sin reescribir la interfaz.  
- **DocumentaciÃ³n y ColaboraciÃ³n:**  
  Se recomienda mantener la documentaciÃ³n actualizada conforme se realicen mejoras o se agreguen nuevos mÃ³dulos.  
- **Seguridad y Privacidad:**  
  Se debe prestar atenciÃ³n a la protecciÃ³n de API keys y la redacciÃ³n adecuada de PII para cumplir con las polÃ­ticas de privacidad y normativas vigentes.

----------------------------------------------------------------
## GuÃ­a de Usuario â€“ Resumen PrÃ¡ctico

1. **Acceso a la AplicaciÃ³n:**  
   Abra su navegador y dirÃ­jase a la URL designada (ejemplo: http://localhost:8501).  
2. **Carga de Archivos:**  
   Utilice la opciÃ³n â€œCargar PDFâ€ o â€œSubir Archivoâ€ para cargar documentos o transcripciones.
3. **EjecuciÃ³n del AnÃ¡lisis:**  
   Una vez procesados, haga clic en â€œAnalizar con LLMâ€ para enviar el contenido a los modelos de lenguaje y generar anÃ¡lisis e insights.
4. **VisualizaciÃ³n y ExportaciÃ³n:**  
   Revise los paneles de resultados (KPIs, Temas, Recomendaciones, Asignaciones) y use las opciones de exportaciÃ³n (descargar JSON o CSV) para obtener los datos.
5. **Soporte:**  
   Para ayuda adicional, revise la secciÃ³n de Preguntas Frecuentes o contacte al equipo de soporte mediante los datos proporcionados en la aplicaciÃ³n.

----------------------------------------------------------------
## Diagrama Final

```mermaid
graph LR
App[app] --> Deps[dependencies]
```

----------------------------------------------------------------
Happy Coding y Â¡Ã©xito en el anÃ¡lisis de la Voz del Cliente!

Para cualquier duda, sugerencia o contribuciÃ³n, se recomienda revisar el repositorio de issues o contactar directamente al equipo de desarrollo.

----------------------------------------------------------------
## Diagrama (Resumen Visual)

```mermaid
graph LR
App["app"] --> Deps["dependencies"]
```


## Diagrama
```mermaid
graph LR\nApp["app"]-->Deps["dependencies"]\n
```
